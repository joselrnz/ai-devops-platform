title: Reverse Shell Detection
id: 6f7g8h9i-0j1k-2l3m-4n5o-p6q7r8s9t0u1
status: stable
description: Detects potential reverse shell connections (netcat, bash, python)
references:
  - https://attack.mitre.org/techniques/T1059/
  - https://attack.mitre.org/techniques/T1071/
author: Jose
date: 2024/01/15
tags:
  - attack.execution
  - attack.command_and_control
  - attack.t1059
  - attack.t1071
logsource:
  category: process_creation
  product: linux
detection:
  selection_nc:
    process.name:
      - 'nc'
      - 'ncat'
      - 'netcat'
    process.command_line|contains:
      - '-e /bin/sh'
      - '-e /bin/bash'
      - '-c /bin/sh'
      - '-c /bin/bash'
  selection_bash:
    process.name: 'bash'
    process.command_line|contains|all:
      - '/dev/tcp/'
      - '>&'
  selection_python:
    process.name:
      - 'python'
      - 'python3'
    process.command_line|contains:
      - 'socket.socket'
      - 'subprocess.call'
      - 'pty.spawn'
  condition: selection_nc or selection_bash or selection_python
fields:
  - process.name
  - process.command_line
  - user.name
  - source.ip
falsepositives:
  - Legitimate remote administration
  - Network diagnostics
level: critical
